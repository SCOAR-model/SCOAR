###################### PREPROCESS ROMS/WW3 FOR SCOAR ################################

This requirs to already have generated the WRF grid (e.g. geo_em_d01.nc)  


####################### FIRST STEP

##Copy the folder with subfolders: EXPNAME

Rename the different folders following the name of your experience

e.g.    expname = miso6
       expname2 = miso6

##############

####################### SECOND STEP

update the crocotools_param

############

######################## FOURTH STEP


update the header of the main script main.sh

You can decide to generate or not the WW3 grid files (if yes, it requires to have the ROMS grid) 

This script will run all the matlab scripts needed to genereate grids and templates for SCOAR
Double check if you have all the matblab toolbox and all at the same location ( check the addpath(**))
 
run ./main.sh


(you can turn on/off the matlab display by adding/removing options -nodisplay -nodesktop)
(roms_expname2_nolake always need display because you need to edit the mask..)

## UPDATE ON PROJECTION ##

This is a first step to use different projections, work is needed to optimize the code.
Right now this allows to use Lambert projection. Polar projection would also be doable but would need some further modifications and it is not done in this current version.
Update on using different projections has been added using main_lambert_proj.sh and wrf_to_roms.py
This code is using Python script and it is needed to install PYROMS librairy to use it.

if using Lambert projection please CHECK wrf_to_roms.py as there are user defined variable needed in it. This needs to be improved in the future..

To add sponge layer variables run the add_sponge.py script after creating the grid (CHECK path and sponge factors in the script).
This eventually needs to be directly included in wrf_to_roms.py

## END UPDATE ON PROJECTION ##

############


######################### LAST STEP 


Outcomes grids are in grid/ROMS/ and grid/WRF/
Copy them to your SCOAR folder Lib/grids

Outcomes netcdf files are in template/*.nc  
Copy them to your SCOAR folder Lib/template


###############


########################## CREATE ROMS BOUNDARY FORCING FILE USING MERCATOR DATA

update the hearder in the create_bdy_ini_files_roms_merc.sh and run it

Outcomes netcdf files are in mercator_bry_expname2/bdy and mercator_bry_expname2/ini
Copy them to your SCOAR folder Data/domains/expname/expname2/ROMS_Input

 

